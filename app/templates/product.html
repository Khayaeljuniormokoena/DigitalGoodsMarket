{% extends "base.html" %}

{% block title %}Product{% endblock %}

{% block content %}
  <h1>{{ product.title }}</h1>
  <div class="row">
    <div class="col-md-6">
      <img src="{{ url_for('static', filename='images/' + product.image) }}" class="img-fluid" alt="Product Image">
    </div>
    <div class="col-md-6">
      <h3>${{ product.price }}</h3>
      <p>{{ product.description }}</p>
      {% if product.is_sold %}
      <button class="btn btn-secondary" disabled>Sold</button>
      {% else %}
      <form action="{{ url_for('main.buy_product', id=product.id) }}" method="post">
        <button type="submit" class="btn btn-primary">Buy Now</button>
      </form>
      {% endif %}
      <hr>
      <form action="{{ url_for('main.add_to_wishlist', product_id=product.id) }}" method="post">
        <button type="submit" class="btn btn-warning">Add to Wishlist</button>
      </form>
    </div>
  </div>
  <hr>
  <h3>Reviews</h3>
  {% for review in reviews %}
  <div class="review">
    <strong>{{ review.author.username }}</strong> - {{ review.rating }}/5
    <p>{{ review.comment }}</p>
  </div>
  {% endfor %}
  {% if current_user.is_authenticated %}
  <form action="{{ url_for('main.product', id=product.id) }}" method="post">
    {{ form.hidden_tag() }}
    <div class="form-group">
      {{ form.rating.label }} {{ form.rating(class="form-control") }}
    </div>
    <div class="form-group">
      {{ form.comment.label }} {{ form.comment(class="form-control") }}
    </div>
    <button type="submit" class="btn btn-success">Submit Review</button>
  </form>
  {% endif %}
{% endblock %}